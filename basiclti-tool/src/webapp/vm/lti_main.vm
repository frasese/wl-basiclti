<script type="text/javascript" src="/library/js/jquery/jquery-ui/js/jquery.js"></script>
<script type="text/javascript" src="/library/js/jquery/jquery-ui/js/jquery-ui.js"></script>
<link type="text/css" href="/library/js/jquery/jquery-ui/css/smoothness/jquery-ui.css" rel="stylesheet" media="screen" />
<script type="text/javascript" src="/library/js/jquery/tablesorter/2.0.3/jquery.tablesorter-2.0.3.min.js"></script> 
<link type="text/css" href="/library/js/jquery/tablesorter/2.0.3/blue/style.css"  rel="stylesheet" media="screen" />

<script type="text/javascript">
	$(document).ready(function() { 
    $("table").tablesorter({
    	sortList: [[0,0]] 
    	});
	    
	    $( "#tabs" ).tabs();
	});	
	</script>
<div class="portletBody">
	<div id="tabs">
		<ul>
			<li><a href="#tabs-site">$tlang.getString("tool.in.site")</a></li>
			<li><a href="#tabs-system">$tlang.getString("tool.in.system")</a></li>
		</ul>
		<div id="tabs-site">
			#if ($messageSuccess)<div class="messageSuccess">$tlang.getString("gen.success") $validator.escapeHtml($messageSuccess)</div><div class="clear"></div>#end
			#if ($alertMessage)<div class="alertMessage">$tlang.getString("gen.alert") $validator.escapeHtml($alertMessage)</div><div class="clear"></div>#end
			<div align="right"><a href="" title="$tlang.getString("add.to.site")" onclick="location = '$sakai_ActionURL.setPanel("ContentPut")';return false;"> $tlang.getString("add.to.site")</a></div>
			<br/>
			$tlang.getString("tool.description.sites")
			<br/>
			#if ($contents && $contents.size() > 0)
				<table id="myTable" class="tablesorter" cellspacing="0" summary ="$tlang.getString("content.table")">
					<thead>
					<tr>
						<th id="title">$tlang.getString("bl_title")</th>
						<th id="url">$tlang.getString("bl_url")</th>
						#if ($isAdmin) <th id="site">$tlang.getString("bl_site")</th> #end
						<th id="action" width="25%">$tlang.getString("bl_action")</th>
				        <th id="page">$tlang.getString("bl_page")</th>
					</tr>
					</thead>
					<tbody>
					#foreach ($content in $contents)
					<tr>
					<td headers="matchpattern">$content.get("title")</td>
					<td headers="url">
						#set($tool=$ltiService.getTool($content.get("tool_id_long")))
						#if ($!tool)
							$tool.get("launch")
						#end
					</td>
					#if ($isAdmin) <td headers="site">$!content.get("SITE_ID")</a></td> #end
					<td headers="action"><a href="$sakai_ActionURL.setPanel("ContentPut")&id=$content.get("id")">$tlang.getString("gen.edit")</a> / 
					<a href="$sakai_ActionURL.setPanel("ContentDelete")&id=$content.get("id")">$tlang.getString("gen.delete")</a>
					#if ( $content.get("launch_url") )
					/ <a href="$content.get("launch_url")" target="_new" "$tlang.getString("gen.test")>$tlang.getString("gen.test")</a>
					#end
					</td>
	                <td headers="page">
		                #if ( $content.get("placement") ) 
							<a href="$sakai_ActionURL.setPanel("LinkRemove")&id=$content.get("id")">$tlang.getString("bl_removelink")</a>
						#else 
							<a href="$sakai_ActionURL.setPanel("LinkAdd")&id=$content.get("id")">$tlang.getString("bl_addlink")</a>
						#end
					</td>
					</tr>
					#end
					</tbody>
				</table>
			#else
				<p>$tlang.getString("content.none")</p>
			#end
			$tlang.getString("content.note")
			#if ( $isAdmin ) 
				$tlang.getString("content.admin.note")
			#end
		</div>
		<div id="tabs-system">
			#if ($messageSuccess)<div class="messageSuccess">$tlang.getString("gen.success") $validator.escapeHtml($messageSuccess)</div><div class="clear"></div>#end
			#if ($alertMessage)<div class="alertMessage">$tlang.getString("gen.alert") $validator.escapeHtml($alertMessage)</div><div class="clear"></div>#end
			<div align="right"><a href="" title="$tlang.getString("add.to.system")" onclick="location = '$sakai_ActionURL.setPanel("ToolInsert")';return false;"> $tlang.getString("add.to.system")</a></div>
			<br/>
			$tlang.getString("tool.description.system")
			<br/>
			#if (!$!systemLtiTools.isEmpty())
				<table class="tablesorter" cellspacing="0" summary ="$tlang.getString("tool.table")">
					<thead>
			        <tr>
		                <th id="attention">&nbsp;</th>
		                <th id="title">$tlang.getString("bl_title")</th>
		                <th id="launch">$tlang.getString("bl_launch")</th>
		                #if ($isAdmin) <th id="use">$tlang.getString("bl_use")</th> #end
		                <th id="action">$tlang.getString("bl_action")</th>
			        </tr>
			        </thead>
			        <tbody>
		            #foreach($tool in $systemLtiToolsMap.entrySet())
		            	
						#set($toolId=$tool.getKey())
						#set($toolValues=$tool.getValue())
						<tr>
							<td headers="attention">
								#if ( $tool.get("secret") == "-----" )
									<span style="color:#903;font-weight:bold;">*</span>
								#else
									&nbsp;
								#end
				                <td headers="title"><a href="$sakai_ActionURL.setPanel("ToolView")&id=$toolValues.get("id")">$toolValues.get("title")</td>
				                <td headers="launch">$toolValues.get("launch")</a></td>
				                #if ($isAdmin) <td headers="use">$toolValues.get("tool_count")</a></td> #end
				                <td headers="action">
				                #if ( $isAdmin || $getContext == $toolValues.get("SITE_ID") ) 
			                        <a href="$sakai_ActionURL.setPanel("ToolEdit")&id=$toolValues.get("id")">$tlang.getString("gen.edit")</a> / 
			                        <a href="$sakai_ActionURL.setPanel("ToolDelete")&id=$toolValues.get("id")">$tlang.getString("gen.delete")</a>
				                #end
			                </td>
		                <tr>
					#end
					</tbody>
				</table>
			#else
				<p>$tlang.getString("tool.none")</p>
			#end
			$tlang.getString("tool.note")
		</div>
	</div>
</div>
